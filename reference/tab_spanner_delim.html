<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create column labels and spanners via delimited column names — tab_spanner_delim • gt</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Create column labels and spanners via delimited column names — tab_spanner_delim"><meta name="description" content="tab_spanner_delim() can take specially-crafted column names and generate
one or more spanners (and revise column labels at the same time). This is
done by splitting the column name by the specified delimiter text (delim)
and placing the fragments from top to bottom (i.e., higher-level spanners to
the column labels) or vice versa. Furthermore, neighboring text fragments on
different spanner levels that have the same text will be coalesced together.
For instance, having the three side-by-side column names rating_1,
rating_2, and rating_3 will (in the default case at least) result in a
spanner with the label &quot;rating&quot; above columns with the labels &quot;1&quot;, &quot;2&quot;,
and &quot;3&quot;. There are many options in cols_spanner_delim() to slice and dice
delimited column names in different ways:
delimiter text: choose the delimiter text to use for the fragmentation of
column names into spanners with the delim argument
direction and amount of splitting: we can choose to split n times
according to a limit argument, and, we get to specify from which side of
the column name the splitting should commence
reversal of fragments: we can reverse the order the fragments we get from
the splitting procedure with the reverse argument
column constraints: it's possible to constrain which columns in a gt
table should participate in spanner creation using vectors or
tidyselect-style expressions

"><meta property="og:description" content="tab_spanner_delim() can take specially-crafted column names and generate
one or more spanners (and revise column labels at the same time). This is
done by splitting the column name by the specified delimiter text (delim)
and placing the fragments from top to bottom (i.e., higher-level spanners to
the column labels) or vice versa. Furthermore, neighboring text fragments on
different spanner levels that have the same text will be coalesced together.
For instance, having the three side-by-side column names rating_1,
rating_2, and rating_3 will (in the default case at least) result in a
spanner with the label &quot;rating&quot; above columns with the labels &quot;1&quot;, &quot;2&quot;,
and &quot;3&quot;. There are many options in cols_spanner_delim() to slice and dice
delimited column names in different ways:
delimiter text: choose the delimiter text to use for the fragmentation of
column names into spanners with the delim argument
direction and amount of splitting: we can choose to split n times
according to a limit argument, and, we get to specify from which side of
the column name the splitting should commence
reversal of fragments: we can reverse the order the fragments we get from
the splitting procedure with the reverse argument
column constraints: it's possible to constrain which columns in a gt
table should participate in spanner creation using vectors or
tidyselect-style expressions

"><meta property="og:image" content="https://gt.rstudio.com/logo.svg"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gt</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.11.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/gt.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/creating-summary-lines.html">Creating Summary Lines</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Case studies</h6></li>
    <li><a class="dropdown-item" href="../articles/case-study-gtcars.html">Case Study: gtcars</a></li>
    <li><a class="dropdown-item" href="../articles/case-study-clinical-tables.html">Case Study: Clinical Tables</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Datasets</h6></li>
    <li><a class="dropdown-item" href="../articles/gt-datasets.html">gt Datasets</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/index.html">More articles...</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/everything-new-thats-in-gt-0-11-0/">Version 0.11.0</a></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/new-features-in-gt-0-10-0/">Version 0.10.0</a></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/?search=gt%2520%25200.9.0">Version 0.9.0</a></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/new-features-upgrades-in-gt-0-8-0/">Version 0.8.0</a></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/all-new-things-in-gt-0-7-0/">Version 0.7.0</a></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/changes-for-the-better-in-gt-0-6-0/">Version 0.6.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/gt/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.svg" class="logo" alt=""><h1>Create column labels and spanners via delimited column names</h1>
      <small class="dont-index">Source: <a href="https://github.com/rstudio/gt/blob/master/R/tab_create_modify.R" class="external-link"><code>R/tab_create_modify.R</code></a></small>
      <div class="d-none name"><code>tab_spanner_delim.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>tab_spanner_delim()</code> can take specially-crafted column names and generate
one or more spanners (and revise column labels at the same time). This is
done by splitting the column name by the specified delimiter text (<code>delim</code>)
and placing the fragments from top to bottom (i.e., higher-level spanners to
the column labels) or vice versa. Furthermore, neighboring text fragments on
different spanner levels that have the same text will be coalesced together.
For instance, having the three side-by-side column names <code>rating_1</code>,
<code>rating_2</code>, and <code>rating_3</code> will (in the default case at least) result in a
spanner with the label <code>"rating"</code> above columns with the labels <code>"1"</code>, <code>"2"</code>,
and <code>"3"</code>. There are many options in <code>cols_spanner_delim()</code> to slice and dice
delimited column names in different ways:</p><ul><li><p>delimiter text: choose the delimiter text to use for the fragmentation of
column names into spanners with the <code>delim</code> argument</p></li>
<li><p>direction and amount of splitting: we can choose to split <em>n</em> times
according to a <code>limit</code> argument, and, we get to specify from which side of
the column name the splitting should commence</p></li>
<li><p>reversal of fragments: we can reverse the order the fragments we get from
the splitting procedure with the <code>reverse</code> argument</p></li>
<li><p>column constraints: it's possible to constrain which columns in a <strong>gt</strong>
table should participate in spanner creation using vectors or
<strong>tidyselect</strong>-style expressions</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">tab_spanner_delim</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  <span class="va">delim</span>,</span>
<span>  columns <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  split <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"last"</span>, <span class="st">"first"</span><span class="op">)</span>,</span>
<span>  limit <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  reverse <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p><em>The gt table data object</em></p>
<p><code>obj:&lt;gt_tbl&gt;</code> // <strong>required</strong></p>
<p>This is the <strong>gt</strong> table object that is commonly created through use of the
<code><a href="gt.html">gt()</a></code> function.</p></dd>


<dt id="arg-delim">delim<a class="anchor" aria-label="anchor" href="#arg-delim"></a></dt>
<dd><p><em>Delimiter for splitting</em></p>
<p><code>scalar&lt;character&gt;</code> // <strong>required</strong></p>
<p>The delimiter text to use to split one of more column names (i.e., those
that are targeted via the <code>columns</code> argument).</p></dd>


<dt id="arg-columns">columns<a class="anchor" aria-label="anchor" href="#arg-columns"></a></dt>
<dd><p><em>Columns to target</em></p>
<p><code>&lt;column-targeting expression&gt;</code> // <em>default:</em> <code><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything()</a></code></p>
<p>The columns to consider for the splitting, relabeling, and spanner setting
operations. Can either be a series of column names provided in <code><a href="https://rdrr.io/r/base/c.html" class="external-link">c()</a></code>, a
vector of column indices, or a select helper function (e.g.,
<code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">contains()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">matches()</a></code>, <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">num_range()</a></code>,
and <code><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">everything()</a></code>).</p></dd>


<dt id="arg-split">split<a class="anchor" aria-label="anchor" href="#arg-split"></a></dt>
<dd><p><em>Splitting side</em></p>
<p><code>singl-kw:[last|first]</code> // <em>default:</em> <code>"last"</code></p>
<p>Should the delimiter splitting occur from the <code>"last"</code> instance of the
<code>delim</code> character or from the <code>"first"</code>? The default here uses the <code>"last"</code>
keyword, and splitting begins at the last instance of the delimiter in the
column name. This option only has some consequence when there is a <code>limit</code>
value applied that is lesser than the number of delimiter characters for a
given column name (i.e., number of splits is not the maximum possible
number).</p></dd>


<dt id="arg-limit">limit<a class="anchor" aria-label="anchor" href="#arg-limit"></a></dt>
<dd><p><em>Limit for splitting</em></p>
<p><code>scalar&lt;numeric|integer|character&gt;</code> // <em>default:</em> <code>NULL</code> (<code>optional</code>)</p>
<p>An optional limit to place on the splitting procedure. The default <code>NULL</code>
means that a column name will be split as many times are there are
delimiter characters. In other words, the default means there is no limit.
If an integer value is given to <code>limit</code> then splitting will cease at the
iteration given by <code>limit</code>. This works in tandem with <code>split</code> since we can
adjust the number of splits from either the right side (<code>split = "last"</code>)
or left side (<code>split = "first"</code>) of the column name.</p></dd>


<dt id="arg-reverse">reverse<a class="anchor" aria-label="anchor" href="#arg-reverse"></a></dt>
<dd><p><em>Reverse vector of split names</em></p>
<p><code>scalar&lt;logical&gt;</code> // <em>default:</em> <code>FALSE</code></p>
<p>Should the order of split names be reversed? By default, this is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>gt_tbl</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details-on-column-splitting">Details on column splitting<a class="anchor" aria-label="anchor" href="#details-on-column-splitting"></a></h2>



<p>If we take a hypothetical table that includes the column names
<code>province.NL_ZH.pop</code>, <code>province.NL_ZH.gdp</code>, <code>province.NL_NH.pop</code>, and
<code>province.NL_NH.gdp</code>, we can see that we have a naming system that has a
well-defined structure. We start with the more general to the left
(<code>"province"</code>) and move to the more specific on the right (<code>"pop"</code>). If the
columns are in the table in this exact order, then things are in an ideal
state as the eventual spanner labels will form from this neighboring.
When using <code>tab_spanner_delim()</code> here with <code>delim</code> set as <code>"."</code> we get the
following text fragments:</p><ul><li><p><code>province.NL_ZH.pop</code> -&gt; <code>"province"</code>, <code>"NL_ZH"</code>, <code>"pop"</code></p></li>
<li><p><code>province.NL_ZH.gdp</code> -&gt; <code>"province"</code>, <code>"NL_ZH"</code>, <code>"gdp"</code></p></li>
<li><p><code>province.NL_NH.pop</code> -&gt; <code>"province"</code>, <code>"NL_NH"</code>, <code>"pop"</code></p></li>
<li><p><code>province.NL_NH.gdp</code> -&gt; <code>"province"</code>, <code>"NL_NH"</code>, <code>"gdp"</code></p></li>
</ul><p>This gives us the following arrangement of column labels and spanner labels:</p>
<p></p><div class="sourceCode default"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>--------- `"province"` ---------- &lt;- level 2 spanner</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>---`"NL_ZH"`--- | ---`"NL_NH"`--- &lt;- level 1 spanners</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>`"pop"`|`"gdp"` | `"pop"`|`"gdp"` &lt;- column labels</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>---------------------------------</span></code></pre><p></p></div>
<p>There might be situations where the same delimiter is used throughout but
only the last instance requires a splitting. With a pair of column names like
<code>north_holland_pop</code> and <code>north_holland_area</code> you would only want <code>"pop"</code> and
<code>"area"</code> to be column labels underneath a single spanner (<code>"north_holland"</code>).
To achieve this, the <code>split</code> and <code>limit</code> arguments are used and the values
for each need to be <code>split = "last"</code> and <code>limit = 1</code>. This will give us
the following arrangement:</p>
<p></p><div class="sourceCode default"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>--`"north_holland"`-- &lt;- level 1 spanner</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a> `"pop"`  |  `"area"` &lt;- column labels</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>---------------------</span></code></pre><p></p></div>
    </div>
    <div class="section level2">
    <h2 id="examples">Examples<a class="anchor" aria-label="anchor" href="#examples"></a></h2>



<p>With a subset of the <code><a href="towny.html">towny</a></code> dataset, we can create a <strong>gt</strong> table and then
use <code>tab_spanner_delim()</code> to automatically generate column spanner labels.
In this case we have some column names in the form <code>population_&lt;year&gt;</code>.
The underscore character is the delimiter that separates a common word
<code>"population"</code> and a year value. In this default way of splitting, fragments
to the right are lowest (really they become new column labels) and moving
left we get spanners. Let's have a look at how <code>tab_spanner_delim()</code> handles
these column names:</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">towny_subset_gt</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">towny</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"population"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^F"</span>, <span class="va">name</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gt.html">gt</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tab_spanner_delim.html">tab_spanner_delim</a></span><span class="op">(</span>delim <span class="op">=</span> <span class="st">"_"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/fmt_integer.html">fmt_integer</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">towny_subset_gt</span></span></code></pre><p></p></div>
<p><img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_tab_spanner_delim_1.png" alt="This image of a table was generated from the first code example in the `tab_spanner_delim()` help file." style="width:100%;"></p>
<p>The spanner created through this use of <code>tab_spanner_delim()</code> is
automatically given an ID value by <strong>gt</strong>. Because it's hard to know what the
ID value is, we can use <code><a href="tab_info.html">tab_info()</a></code> to inspect the table's indices and ID
values.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">towny_subset_gt</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/tab_info.html">tab_info</a></span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p><img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_tab_spanner_delim_2.png" alt="This image of a table was generated from the second code example in the `tab_spanner_delim()` help file." style="width:100%;"></p>
<p>From this informational table, we see that the ID for the spanner is
<code>"spanner-population_1996"</code>. Also, the columns are still accessible by the
original column names (<code>tab_spanner_delim()</code> did change their labels though).
Let's use <code><a href="tab_style.html">tab_style()</a></code> along with <code><a href="cells_column_spanners.html">cells_column_spanners()</a></code> to add some
styling to the spanner label of the <code>towny_subset_gt</code> table.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">towny_subset_gt</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tab_style.html">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="../reference/cell_text.html">cell_text</a></span><span class="op">(</span>weight <span class="op">=</span> <span class="st">"bold"</span>, transform <span class="op">=</span> <span class="st">"capitalize"</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu"><a href="../reference/cells_column_spanners.html">cells_column_spanners</a></span><span class="op">(</span>spanners <span class="op">=</span> <span class="st">"spanner-population_1996"</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre><p></p></div>
<p><img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_tab_spanner_delim_3.png" alt="This image of a table was generated from the third code example in the `tab_spanner_delim()` help file." style="width:100%;"></p>
<p>We can plan ahead a bit and refashion the column names with <strong>dplyr</strong> before
introducing the table to <code><a href="gt.html">gt()</a></code> and <code>tab_spanner_delim()</code>. Here the column
labels have underscore delimiters where splitting is not wanted (so a period
or space character is used instead). The usage of <code>tab_spanner_delim()</code> gives
two levels of spanners. We can further touch up the labels after that with
<code><a href="cols_label_with.html">cols_label_with()</a></code> and <code><a href="text_transform.html">text_transform()</a></code>.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">towny</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice_max</a></span><span class="op">(</span><span class="va">population_2021</span>, n <span class="op">=</span> <span class="fl">5</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">ends_with</a></span><span class="op">(</span><span class="st">"pct"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span></span>
<span>    .fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">x</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"pop_change_"</span>, <span class="st">"Population Change."</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">sub</a></span><span class="op">(</span><span class="st">"_pct"</span>, <span class="st">".pct"</span>, x <span class="op">=</span> <span class="va">_</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gt.html">gt</a></span><span class="op">(</span>rowname_col <span class="op">=</span> <span class="st">"name"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tab_spanner_delim.html">tab_spanner_delim</a></span><span class="op">(</span>delim <span class="op">=</span> <span class="st">"."</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/fmt_number.html">fmt_number</a></span><span class="op">(</span>decimals <span class="op">=</span> <span class="fl">1</span>, scale_by <span class="op">=</span> <span class="fl">100</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cols_label_with.html">cols_label_with</a></span><span class="op">(</span></span>
<span>    fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"pct"</span>, <span class="st">"%"</span>, <span class="va">x</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/text_transform.html">text_transform</a></span><span class="op">(</span></span>
<span>    fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="st">" - "</span>, <span class="va">x</span>, fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu"><a href="../reference/cells_column_spanners.html">cells_column_spanners</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tab_style.html">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="fu"><a href="../reference/cell_text.html">cell_text</a></span><span class="op">(</span>align <span class="op">=</span> <span class="st">"center"</span><span class="op">)</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu"><a href="../reference/cells_column_labels.html">cells_column_labels</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tab_style.html">tab_style</a></span><span class="op">(</span></span>
<span>    style <span class="op">=</span> <span class="st">"padding-right: 36px;"</span>,</span>
<span>    locations <span class="op">=</span> <span class="fu"><a href="../reference/cells_body.html">cells_body</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre><p></p></div>
<p><img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_tab_spanner_delim_4.png" alt="This image of a table was generated from the fourth code example in the `tab_spanner_delim()` help file." style="width:100%;"></p>
<p>With a summarized, filtered, and pivoted version of the <code><a href="pizzaplace.html">pizzaplace</a></code>
dataset, we can create another <strong>gt</strong> table and then use
<code>tab_spanner_delim()</code> with the delimiter/separator also used in
<code><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">tidyr::pivot_wider()</a></code>. We can also process the generated column labels with
<code><a href="cols_label_with.html">cols_label_with()</a></code>.</p>
<p></p><div class="sourceCode r"><pre><code><span><span class="va">pizzaplace</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">date</span>, <span class="va">type</span>, <span class="va">price</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">name</span>, <span class="va">date</span>, <span class="va">type</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span></span>
<span>    revenue <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">price</span><span class="op">)</span>,</span>
<span>    sold <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .groups <span class="op">=</span> <span class="st">"drop"</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">date</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"2015-01-01"</span>, <span class="st">"2015-01-02"</span>, <span class="st">"2015-01-03"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">type</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"classic"</span>, <span class="st">"veggie"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span></span>
<span>    names_from <span class="op">=</span> <span class="va">date</span>,</span>
<span>    names_sep <span class="op">=</span> <span class="st">"."</span>,</span>
<span>    values_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">revenue</span>, <span class="va">sold</span><span class="op">)</span>,</span>
<span>    values_fn <span class="op">=</span> <span class="va">sum</span>,</span>
<span>    names_sort <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/gt.html">gt</a></span><span class="op">(</span>rowname_col <span class="op">=</span> <span class="st">"name"</span>, groupname_col <span class="op">=</span> <span class="st">"type"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/tab_spanner_delim.html">tab_spanner_delim</a></span><span class="op">(</span>delim <span class="op">=</span> <span class="st">"."</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/sub_missing.html">sub_missing</a></span><span class="op">(</span>missing_text <span class="op">=</span> <span class="st">""</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/fmt_currency.html">fmt_currency</a></span><span class="op">(</span>columns <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"revenue"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/data_color.html">data_color</a></span><span class="op">(</span></span>
<span>    columns <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html" class="external-link">starts_with</a></span><span class="op">(</span><span class="st">"revenue"</span><span class="op">)</span>,</span>
<span>    method <span class="op">=</span> <span class="st">"numeric"</span>,</span>
<span>    palette <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"white"</span>, <span class="st">"lightgreen"</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/cols_label_with.html">cols_label_with</a></span><span class="op">(</span></span>
<span>    fn <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">x</span>, <span class="st">" ("</span>, <span class="fu"><a href="../reference/vec_fmt_datetime.html">vec_fmt_datetime</a></span><span class="op">(</span><span class="va">x</span>, format <span class="op">=</span> <span class="st">"E"</span><span class="op">)</span>, <span class="st">")"</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span></code></pre><p></p></div>
<p><img src="https://raw.githubusercontent.com/rstudio/gt/master/images/man_tab_spanner_delim_5.png" alt="This image of a table was generated from the fifth code example in the `tab_spanner_delim()` help file." style="width:100%;"></p>
    </div>
    <div class="section level2">
    <h2 id="function-id">Function ID<a class="anchor" aria-label="anchor" href="#function-id"></a></h2>


<p>2-3</p>
    </div>
    <div class="section level2">
    <h2 id="function-introduced">Function Introduced<a class="anchor" aria-label="anchor" href="#function-introduced"></a></h2>


<p><code>v0.2.0.5</code> (March 31, 2020)</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="tab_spanner.html">tab_spanner()</a></code> to manually create spanners with more control over
spanner labels.</p>
<p>Other part creation/modification functions:
<code><a href="tab_caption.html">tab_caption</a>()</code>,
<code><a href="tab_footnote.html">tab_footnote</a>()</code>,
<code><a href="tab_header.html">tab_header</a>()</code>,
<code><a href="tab_info.html">tab_info</a>()</code>,
<code><a href="tab_options.html">tab_options</a>()</code>,
<code><a href="tab_row_group.html">tab_row_group</a>()</code>,
<code><a href="tab_source_note.html">tab_source_note</a>()</code>,
<code><a href="tab_spanner.html">tab_spanner</a>()</code>,
<code><a href="tab_stub_indent.html">tab_stub_indent</a>()</code>,
<code><a href="tab_stubhead.html">tab_stubhead</a>()</code>,
<code><a href="tab_style.html">tab_style</a>()</code>,
<code><a href="tab_style_body.html">tab_style_body</a>()</code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Richard Iannone, Joe Cheng, Barret Schloerke, Ellis Hughes, Alexandra Lauer, <a href="https://jooyoungseo.github.io/" class="external-link">JooYoung Seo</a>, Ken Brevoort, Olivier Roy, Posit Software, PBC.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

